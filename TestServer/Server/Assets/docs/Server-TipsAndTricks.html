<!DOCTYPE html>
<html lang="en" style="scroll-behavior:smooth" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<title>Tatin: Server Tips</title>
<style media="screen">
html{-webkit-text-size-adjust:100%;}body{margin:0;}main{display:block;}h1{font-size:2em;margin:0.67em 0;}hr{box-sizing:content-box;height:0;overflow:visible;}pre{font-family:monospace, monospace;font-size:1em;}a{background-color:transparent;}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted;}b,strong{font-weight:bolder;}code,kbd,samp{font-family:monospace, monospace;font-size:1em;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-decoration{-webkit-appearance:none;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:list-item;}template{display:none;}[hidden]{display:none;}body{margin:0;font-family:Arial, sans-serif;background-color:#323232;font-size:18px;max-width:900px;padding:0.83em;color:#DDD;margin-left:auto;margin-right:auto;overflow-wrap:break-word;line-height:1.4;}h1,h2,h3,h4,h5,h6{color:hsl(39,97%,83%);padding-left:0;}h1,h2,h3,h4{margin-bottom:0.88em;}h1{font-size:1.8em;margin:0.27em 0 1.11em 0;}h1 > code,h2 > code,h3 > code,h4 > code,h5 > code,h6 > code{font-size:1em;background-color:inherit;}h2{font-size:1.44em;margin:0.55em 0 0.55em 0;padding-top:0.55em;border-bottom:1px solid Silver;}h3{margin:0;margin-top:0.75em;font-size:1.22em;}nav h3{font-size:1.2em;margin:0 0 0.75em 0;}h4{font-size:1em;margin:0;margin-top:0.75em;}h5{font-size:0.94em;margin:0;margin-top:0.60em;padding:0;}h6{font-size:0.88em;margin:0;margin-top:0.60em;padding:0;}hr{border:0;border-top:1px solid silver;}a{color:#A3A3FF;margin:0;padding:0;vertical-align:baseline;}a:visited{color:hsl(270,70%,85%);}a:visited code{color:hsl(270,70%,85%);}a.autoheader_anchor{text-decoration:none;}img{margin-top:0.55em;margin-bottom:0.27em;}ul{list-style-type:disc;}dd{padding-top:0.25em;}p.first_dd{padding-top:0.25em;}li > ul,li > ol{padding-bottom:0;}li{margin-left:1.38em;margin-bottom:0.5em;}ul > li{margin-left:2.5em;}ol > li{margin-left:2.5em;}li ul{margin-left:0.55em;}li ul{margin-left:0.27em;}li p{padding:1px 0 0 0;margin:0.55em 0 0.27em 0;}ul, ol{padding:0;margin:0.3em 0.5em 0.5em 0.5em;}ul ul,ul ol,ol ol,ol ul{margin-top:0.5em;}p{padding:0.6em 0 0 0;margin:0;}pre{position:relative;overflow:auto;padding:0.55em 0.35em 0.55em 0.35em;margin:0.55em 0 0.55em 0 !important;background-color:#1A1A1A;-moz-tab-size:4;tab-size:4;-o-tab-size:4;display:block;font-family:APLFont, monospace;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;border:1px solid silver;line-height:1;border-radius:5px;}pre > code{line-height:1.2;border:0;padding:0;margin:0;background-color:inherit;font-weight:normal;white-space:pre-wrap;}th code ,td code{color:#8B0000;background-color:inherit;padding:0.02em 0.3em;border-radius:5px;border:1px solid #737373;}a code{padding:0;font-size:1em;background-color:inherit;color:inherit;}nav code{background-color:inherit;font-weight:400;}code{font-family:APLFont, monospace;color:#FFC266;background-color:#1A1A1A;line-height:1.4;white-space:nowrap;margin:0 0.2em 0 0.2em;padding:0.02em 0.3em;border-radius:5px;}tbody tr:nth-child(even){background-color:#DAA520;border-bottom:1px solid Gray;}tbody tr:nth-child(odd){background-color:#E6BD56;border-bottom:1px solid Gray;}th{background-color:#C3941D;color:black;border-bottom:1px solid Gray;}th, td{padding:0.5em;vertical-align:top;}table td + td{border-left:1px solid Gray;border-bottom:1px solid Gray;}table th + th{border-left:1px solid Gray;border-bottom:1px solid Gray;}table{margin:0.75em 0;border-collapse:collapse;font-family:APLFont;font-size:1em;line-height:1.0;border:2px solid Black;}table a{color:blue;}table a:visited{color:blue;}thead th{color:black;background-color:#B68A1B;}td{color:black;}tfoot td{color:black;background-color:#B68A1B;font-weight:bold;}li > table{margin:0.55em 0 0.55em 0;}tr{margin:1.11em;}th{font-weight:bold;}blockquote{border-left:0.27em solid silver;padding:0 0.25em;margin:0.5em 0.25em 0.80em 0.5em;}blockquote p{padding:0 0.25em;}blockquote ul li{margin-left:1.38em;}blockquote ol li{margin-left:1.38em;}li > blockquote{margin-left:0;}nav{background-color:#4C4C4C;border:1px solid Silver;padding:0.55em;margin:0.50em 0 1em 0;margin-right:0;overflow:hidden;}nav#main_nav{width:auto;}nav ul{list-style-type:None;margin:0 1em 0.11em 0;padding:0;}nav ul,nav ul{margin-left:2em;}nav > ul ul{margin-left:2em;}nav a{color:#EDEDED;}nav a:visited{color:#B0B0B0;}nav ul li{margin:0 0 0.16em 0;}nav li p{margin:0;padding:0;line-height:1;margin:0;padding:0;}nav li{line-height:1.5;padding:0;margin-top:0;margin-bottom:0;margin-left:2em;}nav p{font-weight:bold;font-size:1em;padding-top:0;margin-bottom:0.5em;}dl{margin-top:0.1em;margin-bottom:0.1em;}dt{margin-top:0.75em;margin-bottom:0.1em;font-weight:bold;}.toc-container{height:auto;margin:0;padding:0.5em 0.5em 0 0;}nav h2{font-size:1.5em;margin:0.27em 1em 0.27em 1em;}div.toc-container ul{margin-left:0.5em;margin-right:1em;padding-left:1em;}[type="checkbox"]{position:absolute;left:-9999px;}label{display:block;width:100%;height:1.1em;cursor:pointer;top:0;padding-left:1em;}div#footnotes_div p{line-height:1.2;padding-bottom:0;padding-top:0;}div#footnotes_div ol{padding-top:0;}@font-face{font-family:"APLFont";src:local("APL385 Unicode"), url("https://misc.aplteam.com/apl385.ttf") format("truetype");}.hide{transition:opacity 400ms, display 400ms;opacity:0;display:none;}.red{color:red;}.center{text-align:center;margin-left:auto;margin-right:auto;}.left{text-align:left;margin-right:0;}.right{text-align:right;margin-left:0;}.print_only{display:none;}div.leanpub{padding:0.83em 0.55em 1.11em 0;margin:0.55em 0 0 0.27em;overflow:auto;display:grid;grid-template-columns:auto 1fr;grid-gap:10px;}div.leanpub p:first-child,div.leanpub h1:first-child,div.leanpub h2:first-child,div.leanpub h3:first-child,div.leanpub ul:first-child,div.leanpub ol:first-child{padding-top:0;}div.leanpub_A{border:1px solid black;background-color:#4C004C;padding:0.55em;margin:1.11em 0 0.83em 0;color:#DDD;}div.leanpub h3,div.leanpub_A h3{font-size:1.2em;padding:0;margin:0;}div.leanpub h4,div.leanpub_A h4{font-size:1.1em;padding:0.27em 0 0 0;margin:0;}div.leanpub h5,div.leanpub h5{font-size:1.0em;padding:0.27em 0 0 0;margin:0;}div.leanpub_A h5,div.leanpub_A h5{font-size:1.0em;padding:0.27em 0 0 0;margin:0;}div.leanpub_A > p:first-child{padding-top:0;margin-top:0;}div.leanpub img{float:left;padding:0.5em;margin:0.5em 1em 0 0;clear:both;background-color:#CCCCFF;}div.leanpub tbody *{background-color:transparent;}div.leanpub p{padding:0.17em 0 0 0;margin:0;}span.leanpub_code{color:Red;}div.leanpub p{display:block;padding:0.44em 0 0 0;}div.leanpub > div{margin-left:3em;}pre[class*="language-"]{position:relative;margin:5px 0;padding:1.75em 0 1.75em 1em;}details summary{cursor:pointer;}details summary > *{display:inline;}div.accordion{border:1px solid silver;padding:0;margin:0.5em 0;background-color:#4C004C;}div.accordion > div{border:1px solid silver;padding:0.5em;margin:0 0;}div.accordion > div p,div.accordion > div ul,div.accordion > div ol,div.accordion > div img,div.accordion > div table{margin-block-end:0.1em;}div.collapsible{border:1px solid silver;padding:0.5em;margin:0.5em 0;background-color:#4C004C;}div.collapsible p,div.collapsible ul,div.collapsible ol,div.collapsible img,div.collapsible table{margin-block-end:0.1em;}ul.checkboxes{list-style:none;margin-left:-2em;padding-left:0;}li{text-indent:0;padding-left:0;line-height:1.4;}ul.checkboxes > li::before{content:"☐ ";}ul.checkboxes > li.checked::before{content:"☒ ";}pre > button{position:absolute;top:5px;right:5px;font-size:0.8em;padding:0.15em;border:1.25px solid #232326;border-top-left-radius:6px;border-top-right-radius:6px;border-bottom-right-radius:6px;border-bottom-left-radius:6px;}pre button:hover{cursor:pointer;background-color:#BCBABB;}#main_nav{position:relative;}#main_nav h2{font-size:1.45em;margin:0;padding:0.5em 0.5em 0em 0.5em;border-bottom:0px solid Silver;}#toc-toggle{position:absolute;top:1.4em;right:1em;border-top-left-radius:6px;border-top-right-radius:6px;border-bottom-right-radius:6px;border-bottom-left-radius:6px;}#toc-list{margin:1em 1em 0.25em 0;}sup, sub{text-decoration:none;}svg{padding:0.5em;background-color:#CCCCFF;}
</style>
<style media="print">
@page{margin:25mm 20mm 25mm 20mm;}body{font-family:Verdana, Arial, "Liberation Sans", sans-serif;font-size:10pt;line-height:1.2;}h1{font-size:150%;}h2{font-size:124%;}h3{font-size:124%;}h4{font-size:116%;}h5{font-size:108%;}h6{font-size:100%;}nav h2{font-size:1em;}h1{margin:0 0 20pt 0;}h2{margin:15pt 0 3pt 0;}h3{margin:10pt 0 0pt 0;}h4{margin:10pt 0 0pt 0;}h5{margin:9pt 0 0pt 0;}h6{margin:9pt 0 0pt 0;}h1,h2,h3,h4,h5,h6{color:black;font-family:"Arial", "Sans";page-break-after:avoid;}h1 > code,h2 > code,h3 > code,h4 > code,h5 > code,h6 > code{font-size:100%;}h2{border-bottom:1pt solid Silver;padding-bottom:2pt;}.h_tag{page-break-after:avoid;break-after:avoid;}abbr[title]{border-bottom:0;text-decoration:none;}a{color:black;margin:0;padding:0;vertical-align:baseline;text-decoration:none;font-style:italic;}a.autoheader_anchor{text-decoration:none;font-style:normal;page-break-after:avoid;break-after:avoid;}ul{list-style-type:square;}ul, ol{padding:0;margin:0;margin-top:10pt;}li > ul,li > ol{padding-bottom:0;padding-top:0;}li{line-height:1.3;margin:2pt 5pt 2pt 13pt;}ul > li, ol > li{margin:0 0 0 15pt;}li ul{margin-left:5pt;}li ul,li ol{margin:0 3pt 0 3pt;}li p{padding:0;margin:2pt 0;line-height:1.3;}p,ul,ol{line-height:1.2;padding:3pt 0 0 0;margin:0;color:black;}ul,ol{margin-top:0;}pre{padding:3pt 6pt;margin:5pt 0;white-space:pre-wrap;background-color:#FAFAFA;border:1pt Silver solid;display:block;font-family:APLFont, monospace;page-break-inside:avoid;overflow:hidden;line-height:1;}pre code{background-color:#FAFAFA;color:Black;padding:0;margin:0;border:0;white-space:pre-wrap;overflow:hidden;}code{font-family:APLFont, monospace;line-height:1.2;font-size:1em;color:#950000;padding:0 2pt;border:1pt solid silver;white-space:nowrap;margin:0 0.2em 0 0.2em;border-radius:5px;}nav code{font-size:0.9em;}table td + td{border-left:1pt solid silver;}table th + th{border-left:1pt solid silver;}th, td{padding:1pt 5pt;border:1pt solid silver;vertical-align:top;}table code{font-style:normal;padding-left:0;padding-right:0;}table{margin:0.75em 0;font-family:APLFont;font-size:1em;padding:0;border:1pt solid silver;border-collapse:collapse;}li > table{margin:10pt 0 10pt 0;}tr{margin:20pt;}th{font-weight:bold;}tfoot td{font-weight:bold;}tbody tr:nth-child(even) td,thead tr th{border-bottom:1pt solid #949494;}blockquote{border-left:5pt solid silver;padding-left:5pt;margin:8pt 3pt 8pt 8pt;margin:0.5em 0.2em 0.5em 0.5em;}blockquote p{padding:0 0.25em;}nav{background-color:#f8f8f8;border:1pt solid Gray;width:auto;padding:5pt 5pt 5pt 0;margin:5pt 0;overflow:hidden;}nav ul{list-style-type:none;margin:6pt 0 3pt 0;padding:0;}nav ul li{margin-top:3pt;margin-bottom:3pt;}nav li p{margin:0;padding:0;line-height:1;margin:0;padding:0;}nav li{line-height:1;padding:0;margin-top:0;margin-bottom:0;margin-left:8pt;}dl{margin-top:0;margin-bottom:10pt;}dt{margin-top:10pt;margin-bottom:0;font-weight:800;page-break-inside:avoid;}dd{margin-top:2pt;}label#hide_toc_label{font-size:65%;}.toc-container{background-color:inherit;}.toc-container h3{margin:0 0 2pt 7pt;}[type="checkbox"]{display:none;}label{display:block;width:100%;height:1.1em;top:0;padding-left:10pt;}a.external_link::before{content:" 🔗 ";}a.bookmark_link::before{content:" ➯";}a.mailto_link::before{content:" ✉"}nav a.bookmark_link{font-style:normal;}nav p{margin-left:10pt;font-weight:bold;font-size:0.85em;}nav a{font-style:normal;}nav a.bookmark_link::before{content:"";}div#footnotes_div a::before{content:"";}div#footnotes_div a{font-style:normal;}div#footnotes_div{page-break-inside:avoid;}@font-face{font-family:"APLFont";src:local("APL385 Unicode"), url("https://misc.aplteam.com/apl385.ttf") format("truetype");}.no_print{display:none;}.print{display:block;}.red{color:red;}.center{text-align:center;margin:0 auto;}.left{text-align:left;margin-right:0;}.right{text-align:right;margin-left:0;}.avoid_page_break{page-break-inside:avoid;}.page_break_before{page-break-before:always;}div.leanpub{margin:10pt 0 10pt 8pt;page-break-inside:avoid;display:grid;grid-template-columns:auto 1fr;grid-gap:10pt;align-items:top;}div.leanpub_A{border:1pt solid black;background-color:#f9f9f9;padding:5pt;margin:10pt 0 10pt 0;page-break-inside:avoid;}div.leanpub h3,div.leanpub_A h3{font-size:1.2em;padding:3pt 0 0 0;margin:0;}div.leanpub h4,div.leanpub_A h4{font-size:1.1em;padding:3pt 0 0 0;margin:0;}div.leanpub h5,div.leanpub h5{font-size:1.0em;padding:3pt 0 0 0;margin:0;}div.leanpub_A h5,div.leanpub_A h5{font-size:1.0em;padding:3pt 0 0 0;margin:0;}div.leanpub img{padding:0;margin:0 10pt 2pt 0;}div.leanpub_A > p:first-child{padding-top:0;margin-top:0;}div.leanpub > div > h1:first-child{padding-top:5pt;}div.leanpub img{float:left;padding:0;margin:5pt 10pt 0 0;clear:both;}span.leanpub_code{font-weight:bold;}div.leanpub p{display:block;padding:3pt 0 0 0;margin:0;}div.leanpub p:first-child,div.leanpub h1:first-child,div.leanpub h2:first-child,div.leanpub h3:first-child,div.leanpub ul:first-child,div.leanpub ol:first-child{padding-top:0;}div.leanpub > div{margin-left:35pt;}sup{font-size:0.75em;line-height:0;position:relative;vertical-align:baseline;top:-0.4em;}pre[class*="language-"]{position:relative;margin:5pt 0;padding:1.75rem 0 1.75rem 1rem;}pre[class*="language-"] button{position:absolute;top:5pt;right:5pt;}div.accordion{padding:0;margin:0.5em 0;}div.accordion > div{border:1pt solid silver;padding:0.5em;margin:0 0;}div.accordion > div p,div.accordion > div ul,div.accordion > div ol,div.accordion > div img,div.accordion > div table{margin-block-end:0.1em;}summary{display:block;}div.collapsible{border:1pt solid silver;padding:0.5em;margin:0.5em 0;}div.collapsible p,div.collapsible ul,div.collapsible ol,div.collapsible img,div.collapsible table{margin-block-end:0.1em;}ul.checkboxes{list-style:none;margin-left:-2rem;padding-left:0;}li{padding-left:1rem;text-indent:0;}ul.checkboxes > li::before{content:"☐ ";}ul.checkboxes > li.checked::before{content:"☒ ";}pre > button{display:none;}#toc-toggle{display:none;}#main_nav h2{margin:0;padding:0.5em 1em;border-bottom:1pt solid silver;}}
</style>

<script>

// Function that makes sure that all "Collapsibles" are extended (open) when printing
// We have to make sure that everything is going to be printed
window.matchMedia("print").addEventListener("change", evt => {
    if (evt.matches) {
        elms = document.body.querySelectorAll("details:not([open])");
        for (e of elms) {
            e.setAttribute("open", "");
            e.dataset.wasclosed = "";
        }
    } else {
        elms = document.body.querySelectorAll("details[data-wasclosed]");
        for (e of elms) {
            e.removeAttribute("open");
            delete e.dataset.wasclosed;
        }
    }
})
// End "PrintingCollapsibles"


</script>

</head>
<body>
<div class="h_tag">
<a href="#server-tips-and-tricks" id="server-tips-and-tricks" class="autoheader_anchor">
<h1 data-id="Server-Tips-and-tricks">Server: Tips and tricks</h1>
</a>
</div>
<nav id="main_nav" class="toc">
<h2 id="toc-heading">Table of contents</h2>
<button id="toc-toggle" aria-controls="toc-list" aria-expanded="false">Show</button>

<div class="toc-container">
<ul id="toc-list" class="hide print">
<li class="toc-entry toc-h2"><a href="#maintenance">1. Maintenance</a>
<ul>
<li class="toc-entry toc-h3"><a href="#tags">1.1. Tags</a></li>
</ul></li>
<li class="toc-entry toc-h2"><a href="#developing">2. Developing</a>
<ul>
<li class="toc-entry toc-h3"><a href="#structure">2.1. Structure</a></li>
<li class="toc-entry toc-h3"><a href="#version">2.2. Version</a></li>
<li class="toc-entry toc-h3"><a href="#developing-with-a-running-server">2.3. Developing with a running server</a></li>
</ul></li>
<li class="toc-entry toc-h2"><a href="#misc">3. Misc</a>
<ul>
<li class="toc-entry toc-h3"><a href="#special-rest-commands">3.1. Special REST commands</a></li>
<li class="toc-entry toc-h3"><a href="#executing-the-tatin-test-suite">3.2. Executing the Tatin test suite</a></li>
<li class="toc-entry toc-h3"><a href="#creating-a-new-version">3.3. Creating a new version</a></li>
<li class="toc-entry toc-h3"><a href="#licensing">3.4. Licensing</a>
</li></ul></li>
</ul>
</div>
</nav>
<p>Once you've installed a server there are a couple of things that need to be taken care of.</p>
<div class="h_tag">
<a href="#maintenance" id="maintenance" class="autoheader_anchor">
<h2 data-id="Maintenance">1. Maintenance</h2>
</a>
</div>
<div class="h_tag">
<a href="#tags" id="tags" class="autoheader_anchor">
<h3 data-id="Tags">1.1. Tags</h3>
</a>
</div>
<p>The most important thing is to watch tags. Tags can be very useful to find a package, but the problem is that package authors tend to use different tags for the same thing, use legal but different spelling (UK versus US) or invalid spelling, tags that make no sense like adding the group name or “dyalog” etc.</p>
<p>That means that for tags to work there has to be a gatekeeper who is responsible for correcting/removing/adding tags.</p>
<p>That gatekeeper needs to be able to execute code on the server, but only once. The idea is to correct problems in the package config files somehow.</p>
<div class="leanpub_A">
<h3>The package config file and the ZIP file</h3>
<p>Note that changing the config file is enough: If the file got changed then Tatin will make sure that the new version is automatically also added to the ZIP file of the package, effectively overwriting the old version of the package file.</p>
</div>

<p>This can be achieved by uploading an <code>.aplf</code> text file (read: a function) into a folder that is defined in the INI file as <code>[CONFIG]MaintenancePath</code>.</p>
<p>If one or more of such files are found by the Tatin Server while doing housekeeping, they are loaded into the server and executed. Once executed the files are renamed by adding an extension <code>.executed</code>.</p>
<p>For example, if there is a file <code>RemoveDyalogFromTags.aplf</code> then it is loaded into an unnamed namespace and called with a right argument <code>G</code> (for “globals”). Once executed the file is then renamed to <code>RemoveDyalogFromTags.aplf.executed</code>.</p>
<p>That makes sure the code is not executed again, but it is also useful for documenting what code was executed, and when.</p>
<div class="h_tag">
<a href="#crashing-maintenance-files" id="crashing-maintenance-files" class="autoheader_anchor">
<h4 data-id="Crashing-maintenance-files">1.1.1. Crashing maintenance files</h4>
</a>
</div>
<p>Like any other program, a maintenance file may crash. If that happens the server carries out the following steps:</p>
<ol start="1">
<li>Report it to the log file</li>
<li>Send an email reporting the crash with details to the maintainer (if enabled in the INI file)</li>
<li>Rename the file from <code>*.aplf</code> to <code>*.crashed</code> — we don't want that function to be executed again</li>
</ol>
<div class="h_tag">
<a href="#developing" id="developing" class="autoheader_anchor">
<h2 data-id="Developing">2. Developing</h2>
</a>
</div>
<p>If you want to make changes or add new features you need a good understanding of the basic design of Tatin.</p>
<div class="h_tag">
<a href="#structure" id="structure" class="autoheader_anchor">
<h3 data-id="Structure">2.1. Structure</h3>
</a>
</div>
<div class="h_tag">
<a href="#main-namespaces" id="main-namespaces" class="autoheader_anchor">
<h4 data-id="Main-namespaces">2.1.1. Main namespaces</h4>
</a>
</div>
<p>Four ordinary namespaces contain all the Tatin code:</p>
<dl>
<dt><code>Admin</code></dt>
<dd><p>Contains helpers useful to administrate Tatin, for example creating a new version, performing maintenance tasks etc.</p></dd>
</dl>
<p><code>Client</code></p>
<p>Contains the code executed on the Client side of Tatin.</p>
<p><code>Server</code></p>
<p>Contains the code to run a Tatin Server</p>
<p><code>Registry</code></p>
<p>Contains all code that is shared by a Tatin client and a Tatin server.</p>
<div class="h_tag">
<a href="#other-stuff" id="other-stuff" class="autoheader_anchor">
<h4 data-id="Other-stuff">2.1.2. Other stuff</h4>
</a>
</div>
<p>There are some more ordinary namespaces that are used by Tatin</p>
<dl>
<dt><code>Plodder</code></dt>
<dd><p class="first_dd">A fully-fledged HTTP server that is based on Rumba and Conga</p></dd>
<dd><p>For details see <a href="https://github.com/aplteam/Plodder" class="external_link">https://github.com/aplteam/Plodder</a></p></dd>
<dt><code>RumbaLean</code></dt>
<dd><p class="first_dd">An implementation of HTTP 1.1 in APL</p></dd>
<dd><p>For details see <a href="https://github.com/aplteam/RumbaLean" class="external_link">https://github.com/aplteam/RumbaLean</a></p></dd>
</dl>
<p>These two are not part of the Tatin project.</p>
<div class="h_tag">
<a href="#version" id="version" class="autoheader_anchor">
<h3 data-id="Version">2.2. Version</h3>
</a>
</div>
<p>Note that by design new versions always comprehend both the server and the client, so the version number is always the same for both.</p>
<div class="h_tag">
<a href="#developing-with-a-running-server" id="developing-with-a-running-server" class="autoheader_anchor">
<h3 data-id="Developing-with-a-running-server">2.3. Developing with a running server</h3>
</a>
</div>
<p>You might want to run a server while Tatin is an open Cider project. The running server allows you to investigate what the code is doing, and at the same time, any changes and additions would be tracked by Link.</p>
<p>You might even want to run the server in one workspace as an opened Cider project and at the same time run the test cases in another workspace, also as an opened Cider project. Of course you need to be very careful because otherwise you might loose code.</p>
<p>Let's assume that you want to run the Tatin server that is part of the Tatin project. When the Tatin test cases are executed, Tatin would ask you whether you want to start the server automatically – that is the server we are talking about, <strong>not</strong> https://test.tatin.dev.</p>
<p>However, when the server is started as part of the tests it is NOT opened as a Cider project, and changes would not be tracked by Link. If you want that then execute the following steps instead:</p>
<ol start="1">
<li>Open the Tatin project with <code>]Cider.OpenProject</code> with the <code>watch</code> parameter set to “both”.</li>
<li>Run the function <code>#.Tatin.TestCasesServer.RunTests</code></li>
</ol>
<div class="collapsible">
<details>
<summary>
<h3>A word of warning</h3>
</summary>
<div class="collapsible-content">
<hr>
<p>Opening Tatin as a project in two different workspaces, and then make changes to the code in both of them is of course dangerous!</p>
<p>On Windows or when .NET is available you can limit the danger by doing this:</p>
<ul>
<li>Make sure that Link's <code>Notify</code> parameter is set to 1. That makes Link print to the session whenever it updates a file or the workspace, so you get some feedback on what is happening. Make sure you watch this!</li>
<li>Make sure that you set Link's <code>watch</code> parameter to “both” in both workspaces.
<p>That ensure that when you change an APL object in on workspace, it will not only be written do disk but Link will also bring that change into the other workspace.</p></li>
</ul>
<p>This is particularly important when you change code in the <code>Tatin.Registry</code> namespace, because that code is shared between the client and the server.</p>
<p>Taking these measure is important because the mechanism used by Dyalog works most of the time but not always (it's a .NET-problem!), so it is important to watch out for such problems.</p>
<p>On non-Windows platforms with no .NET available, <code>watch=both</code> is not an option at the time of writing (July 2024), so that is particularly dangerous.</p>
</div>
</details>
</div>
<p>If you just want to run the test server, close the project before executing <code>#.Tatin.TestCasesServer.RunTests</code>.</p>
<p>The main handlers are:</p>
<ul>
<li><code>#.Tatin.Server.OnRequest</code></li>
<li><code>#.Tatin.Server.OnHouseKeeping</code></li>
</ul>
<p><code>OnRequest</code> will eventually call one of these:</p>
<ul>
<li><code>Handle_GET</code></li>
<li><code>Handle_PUT_And_POST</code></li>
<li><code>Handle_Delete</code></li>
</ul>
<p>These will call the Tatin functions that perform the real actions.</p>
<div class="h_tag">
<a href="#error-trapping" id="error-trapping" class="autoheader_anchor">
<h4 data-id="Error-trapping">2.3.1. Error trapping</h4>
</a>
</div>
<p>Keep in mind that error trapping is active, so when you change a function and inject a typo this will trigger error trapping once your code gets executed.</p>
<p>If there is any danger of you locking horns with error trapping, consider putting this into <code>OnRequest</code>:</p>
<p><code>⎕TRAP←0 'S'  ⍝TODO⍝</code></p>
<p>Also, make <code>⎕TRAP</code> a local variable in <code>OnRequest</code>.</p>
<p><code>⍝TODO⍝</code> is a reminder that won't go unnoticed: there is a test case that will detect these markers and report them, so it's pretty hard to forget them.</p>
<div class="h_tag">
<a href="#misc" id="misc" class="autoheader_anchor">
<h2 data-id="Misc">3. Misc</h2>
</a>
</div>
<div class="h_tag">
<a href="#special-rest-commands" id="special-rest-commands" class="autoheader_anchor">
<h3 data-id="Special-REST-commands">3.1. Special REST commands</h3>
</a>
</div>
<p>A Tatin server can offer several special REST commands only useful for a developer when testing Tatin. They should never be available on a production server.</p>
<p>Whether these commands would be carried out is decided by the INI entry <code>[CONFIG]SpecialCommands</code>.</p>
<p>One of the commands will return an HTML page with all available commands. We use this as an example.</p>
<p>In a Browser enter this URL:</p>
<pre tabindex="0"><code>https://localhost:5001/v1/list-commands</code></pre>
<p>Note that with the exception <code>list-commands</code>, these commands do not return HTML, they rather trigger actions.</p>
<div class="h_tag">
<a href="#executing-the-tatin-test-suite" id="executing-the-tatin-test-suite" class="autoheader_anchor">
<h3 data-id="Executing-the-Tatin-test-suite">3.2. Executing the Tatin test suite</h3>
</a>
</div>
<p>The test framework used is very powerful, and offers lots of options. Naturally only the basics are covered here.</p>
<p>For more information refer to <a href="https://github.com/aplteam/Tester2" class="external_link">https://github.com/aplteam/Tester2</a></p>
<div class="h_tag">
<a href="#execute-the-complete-test-suite" id="execute-the-complete-test-suite" class="autoheader_anchor">
<h4 data-id="Execute-the-complete-test-suite">3.2.1. Execute the complete test suite</h4>
</a>
</div>
<p>This can be achieved by executing:</p>
<pre tabindex="0"><code>#.Tatin.TestCases.RunTests</code></pre>
<p>This prepares the test framework and then executes all tests in debug mode, meaning that in case something goes wrong, the framework will stop and you can investigate right away,</p>
<p>You will be asked whether you want to copy the test data to a temp folder in preperation.</p>
<p>On Windows you will also be asked whether you want to start a test server. Usually you will answer both questions with “yes”. On Non-Windows platforms you will be asked to start the server yourself before carrying on.</p>
<div class="h_tag">
<a href="#execute-particular-tests-or-group-of-tests" id="execute-particular-tests-or-group-of-tests" class="autoheader_anchor">
<h4 data-id="Execute-particular-tests-or-group-of-tests">3.2.2. Execute particular tests or group(s) of tests</h4>
</a>
</div>
<p>Sometimes it makes sense to execute not all but a small subset of test cases. In this case you might not need test data, or a running test server, depending on that test cases you are about to execute.</p>
<p>This can be achieved as well; first you need to excute:</p>
<pre tabindex="0"><code>#.Tatin.TestCases.Prepare</code></pre>
<p>This initializes Tatin as a client and prepares for creating a code-coverage report. It also creates a number of references needed by the tests.</p>
<p>You only need to call <code>Prepare</code> once.</p>
<p>In a second step you can excute one or more tests. A couple of examples:</p>
<p>Execute one particular test of the <code>UC</code> group:</p>
<pre tabindex="0"><code>#.Tatin.TestCases.T.RunThese 'UC' 600</code></pre>
<p>Execute several tests of the <code>UC</code> group:</p>
<pre tabindex="0"><code>#.Tatin.TestCases.T.RunThese 'UC' (600 601 602)
</code></pre>
<p>Execute all tests belonging to the <code>UC</code> group:</p>
<pre tabindex="0"><code>#.Tatin.TestCases.T.RunThese 'UC'</code></pre>
<div class="h_tag">
<a href="#execute-just-batch-tests" id="execute-just-batch-tests" class="autoheader_anchor">
<h4 data-id="Execute-just-batch-tests">3.2.3. Execute just batch tests</h4>
</a>
</div>
<p>A small number of tests require a user that can be asked to perform actions, like closing an edit window.</p>
<p>Sometimes you might want to execute only tests that do not require a human in front of the monitor. These are called batch tests.</p>
<p>These tests can be executed by executing:</p>
<pre tabindex="0"><code>#.Tatin.TestCases.RunBatchTests 1</code></pre>
<p>The 1 required as right argument is just a safety net against accidental calls.</p>
<p>By default error trapping is in place: in case a test case fails or crashes, this is covered, and the test framework carries on.</p>
<p>If you want batch tests to stop in case of a problem, you must specify the optional <code>debug</code> flag as left argument:</p>
<pre tabindex="0"><code>1 #.Tatin.TestCases.RunBatchTests 1</code></pre>
<div class="h_tag">
<a href="#creating-a-new-version" id="creating-a-new-version" class="autoheader_anchor">
<h3 data-id="Creating-a-new-version">3.3. Creating a new version</h3>
</a>
</div>
<ol start="1">
<li>Check <code>#.Tatin.Registry.Version</code> for being correct</li>
<li>Check <code>#.Tatin.Registry.History</code> for being correct</li>
<li>Check the document <code>docs/ReleaseNotes.md</code> for being correct</li>
<li>Ask Cider how to “Make” a new version with <code>]Cider.Make</code></li>
</ol>
<p>It will tell you to execute:</p>
<pre tabindex="0"><code>#.Tatin.Admin.Make 0</code></pre>
<p>The right argument is a batch flag: it tells the function whether a human is available (0) or not (1). If there is, progress is reported to <code>⎕SE</code>. Naturally the latter is used in order to automatically create a new version.</p>
<p>Note that if the batch flag is 0, the function will print a statement to the session which, when executed, will install the new version.</p>
<div class="h_tag">
<a href="#licensing" id="licensing" class="autoheader_anchor">
<h3 data-id="Licensing">3.4. Licensing</h3>
</a>
</div>
<div class="h_tag">
<a href="#ini-entries" id="ini-entries" class="autoheader_anchor">
<h4 data-id="INI-entries">3.4.1. INI entries</h4>
</a>
</div>
<p>The names of the licenses as well as the URLs that are to be accepted by a server must be defined in the INI file of the server within the <code>[LICENSE]</code> section.</p>
<p>Note that the INI section <code>[LICENSE]</code> <em>may</em> exist, but it does not have to: if it does not, then no menu item “Licensing” will show in the main menu of the website, and the server will accept any license, including packages that do not even carry a property <code>license</code>.</p>
<div class="h_tag">
<a href="#the-menu-item-licensing" id="the-menu-item-licensing" class="autoheader_anchor">
<h4 data-id="The-menu-item-Licensing">3.4.2. The menu item “Licensing”</h4>
</a>
</div>
<p>The text shown on the web page is defined in the document “Licensing.html” in the <code>html/</code> folder.</p>
<div class="h_tag">
<a href="#a-license-file" id="a-license-file" class="autoheader_anchor">
<h4 data-id="A-LICENSE-file">3.4.3. A “LICENSE” file</h4>
</a>
</div>
<p>By convention a file named “LICENSE” when placed in the root of the project will be copied automatically to the root of a package when build by <code>BuildPackage</code>. This convention is independent from the INI file.</p>

<script>

// Adds a "Copy" button to every code block & established the event handler
const copyButtonLabel = " Copy " ;

let blocks = document.querySelectorAll("pre");

blocks.forEach((block) => {
  if (navigator.clipboard) {
    let button = document.createElement("button");

    button.innerText = copyButtonLabel;
    button.title = "Copies the code block to the clipboard.";
    block.appendChild(button);
     
    button.addEventListener("click", async () => {
      await copyCode(block, button);
    });
  }  
});  

async function copyCode(block, button) {
  let code = block.querySelector("code");
  let text = code.innerText;

  await navigator.clipboard.writeText(text);

  button.innerText = " Copied ";

  setTimeout(() => {
    button.innerText = copyButtonLabel;
  }, 700);
}


// Toggle the visibility of the TOC when the "Hide/Show" button is clicked
const button = document.querySelector("#toc-toggle");
const content = document.querySelector("#toc-list");
button.addEventListener("click", toggleTableOfContents);
function toggleTableOfContents() {
  content.classList.toggle("hide");
  if (button.innerText === "Hide") {
    button.innerText = "Show";
    button.setAttribute("aria-expanded", false);
  } else {
    button.innerText = "Hide";
    button.setAttribute("aria-expanded", true);
  }
}

</script>

</body>
</html>
