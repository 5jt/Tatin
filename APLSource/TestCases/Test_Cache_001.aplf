 r←Test_Cache_001(stopFlag batchFlag);⎕TRAP;res;tempDir
⍝ Install a package with plenty of dependencies and check the cache before and after
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 r←T._Failed

 #.⎕SHADOW'TEMP' ⋄ 'TEMP'#.⎕NS''
 tempDir←∆GetTempDir'/packages'

 res←TC.InstallPackage'[tatin]aplteam-HandleError'tempDir
 →T.PassesIf∨/'-HandleError-'⍷∊res
 →T.PassesIf 1<≢F.ListDirs tempDir,'/'
 →T.PassesIf 1<≢F.ListDirs TC.GetPathToPackageCache,'/tatin.dev'
 →T.PassesIf 0=≢F.ListDirs TC.GetPathToPackageCache,'/temp/'

 TC.LoadDependencies tempDir #.TEMP
 →T.PassesIf 9=#.TEMP.⎕NC'HandleError'

 r←T._OK
⍝Done
