 r←Test_API_001(stopFlag batchFlag);⎕TRAP;res1;qdmx
⍝ Exercise ⎕SE.Tatin.ListRegistries
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 r←T._Failed

 res1←⎕SE.Tatin.ListRegistries''
 →T.PassesIf 2<≢res1
 →T.PassesIf 3=2⊃⍴res1

 res1←⎕SE.Tatin.ListRegistries 0
 →T.PassesIf 2<≢res1
 →T.PassesIf 3=2⊃⍴res1

 res1←⎕SE.Tatin.ListRegistries 1
 →T.PassesIf 2<≢res1
 →T.PassesIf 5=2⊃⍴res1

 res1←1 ⎕SE.Tatin.ListRegistries 0
 →T.PassesIf 0<≢res1
 →T.PassesIf 3=2⊃⍴res1

 res1←1 ⎕SE.Tatin.ListRegistries 1
 →T.PassesIf 0<≢res1
 →T.PassesIf 5=2⊃⍴res1

 :Trap 98
     res1←⎕SE.Tatin.ListRegistries 10
     →T.FailsIf 1
 :Else
     qdmx←⎕DMX
     →T.PassesIf'"type" (⍵) must be a Boolean or empty'≡qdmx.EM
 :EndTrap

 :Trap 98
     res1←3 ⎕SE.Tatin.ListRegistries''
     →T.FailsIf 1
 :Else
     qdmx←⎕DMX
     →T.PassesIf'"rawFlag" (⍺) must be a Boolean'≡qdmx.EM
 :EndTrap


 r←T._OK
⍝Done
